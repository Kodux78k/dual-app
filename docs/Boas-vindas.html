<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Boas-vindas Infodose - COBLUX</title>
<style>
  /* Reset rápido */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
  }
  body, html {
    width: 320px;
    height: 178px;
    overflow: hidden;
    background: #000011;
    position: relative;
    color: #00ffff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  canvas#bgParticles {
    position: absolute;
    top: 0; left: 0;
    width: 320px;
    height: 178px;
    z-index: 0;
  }
  main#welcome {
    position: relative;
    z-index: 10;
    width: 90%;
    text-align: center;
  }
  h1 {
    font-weight: 700;
    font-size: 1.6rem;
    color: #0ff;
    text-shadow:
      0 0 8px #0ff,
      0 0 15px #ff00ff,
      0 0 20px #00ffff,
      0 0 25px #ff00ff;
    margin-bottom: 4px;
    user-select: text;
  }
  p {
    font-size: 0.85rem;
    line-height: 1.2;
    color: #ff00ff;
    text-shadow: 0 0 5px #ff00ff;
    margin-bottom: 12px;
  }
  textarea#infodoseInput {
    width: 100%;
    height: 50px;
    background: #001122;
    color: #00ffff;
    border: 1.5px solid #ff00ff;
    border-radius: 6px;
    padding: 6px 8px;
    font-size: 0.8rem;
    resize: none;
    outline-offset: 2px;
    transition: border-color 0.3s ease;
  }
  textarea#infodoseInput:focus {
    border-color: #00ffff;
    background: #002233;
  }
  button {
    margin-top: 8px;
    background: linear-gradient(45deg, #00ffff, #ff00ff);
    color: #000011;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    box-shadow:
      0 0 8px #00ffff,
      0 0 15px #ff00ff;
    user-select: none;
    transition: filter 0.25s ease;
  }
  button:hover,
  button:focus {
    filter: brightness(1.2);
    outline: none;
  }
  /* Player toggle */
  button#toggleSound {
    margin-top: 10px;
    width: 80px;
    font-size: 0.85rem;
    background: linear-gradient(45deg, #00ffff 40%, #ff00ff 60%);
  }
  /* Arquétipo text */
  #arqText {
    margin-top: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    color: #0ff;
    text-shadow:
      0 0 6px #0ff,
      0 0 12px #ff00ff;
    user-select: none;
  }
  /* Sonzinho hover/click: botão será acessível com aria-label e roles */
</style>
</head>
<body>

<canvas id="bgParticles" aria-hidden="true"></canvas>

<main id="welcome" role="main" aria-label="Área principal de boas-vindas Infodose">
  <h1 tabindex="0">Seja bem-vindo à Infodose</h1>
  <p tabindex="0">Ajuste sua experiência com COBLUX e a Fórmula Dopamina Sex.</p>
  <textarea id="infodoseInput" aria-label="Campo para colar sua base Infodose" placeholder="Cole sua base Infodose aqui..."></textarea>
  <button id="btnArq" aria-label="Navegar arquétipos 3, 6 e 9">Arquétipo: <span id="arqText">3</span></button>
  <button id="toggleSound" aria-pressed="false" aria-label="Ativar ou desativar som ambiente">Som: OFF</button>
</main>

<script>
(() => {
  // --- Setup canvas particles ---
  const canvas = document.getElementById('bgParticles');
  const ctx = canvas.getContext('2d');
  let W = canvas.width = 320;
  let H = canvas.height = 178;

  // Partícula básica para efeito místico suave
  class Particle {
    constructor() {
      this.reset();
    }
    reset() {
      this.x = Math.random() * W;
      this.y = Math.random() * H;
      this.radius = 0.8 + Math.random() * 1.2;
      this.speedX = (Math.random() - 0.5) * 0.1;
      this.speedY = (Math.random() - 0.5) * 0.1;
      this.alpha = 0.15 + Math.random() * 0.25;
      this.color = `rgba(0,255,255,${this.alpha})`;
    }
    update() {
      this.x += this.speedX;
      this.y += this.speedY;
      if (this.x < 0 || this.x > W || this.y < 0 || this.y > H) this.reset();
    }
    draw() {
      ctx.beginPath();
      ctx.shadowColor = '#0ff';
      ctx.shadowBlur = 6;
      ctx.fillStyle = this.color;
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
      ctx.fill();
    }
  }
  let particles = [];
  const PARTICLE_COUNT = 60;
  for(let i=0; i<PARTICLE_COUNT; i++) particles.push(new Particle());

  function animateParticles() {
    ctx.clearRect(0,0,W,H);
    for(let p of particles){
      p.update();
      p.draw();
    }
    requestAnimationFrame(animateParticles);
  }
  animateParticles();

  // --- Arquétipo 3|6|9 ---
  const arqBtn = document.getElementById('btnArq');
  const arqText = document.getElementById('arqText');
  const arquetipos = ['3','6','9'];
  let arqIndex = 0;

  // Sons hover/click (simples beep via Web Audio)
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

  function playClickSound(){
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = 'triangle';
    o.frequency.setValueAtTime(600, audioCtx.currentTime);
    g.gain.setValueAtTime(0.05, audioCtx.currentTime);
    o.connect(g);
    g.connect(audioCtx.destination);
    o.start();
    o.stop(audioCtx.currentTime + 0.1);
  }

  arqBtn.addEventListener('click', () => {
    playClickSound();
    arqIndex = (arqIndex +1) % arquetipos.length;
    arqText.textContent = arquetipos[arqIndex];
    // efeito visual simples para feedback
    arqText.style.transition = 'none';
    arqText.style.transform = 'scale(1.3)';
    arqText.style.color = ['#00ffff','#ff00ff','#0ff'][arqIndex];
    setTimeout(() => {
      arqText.style.transition = 'transform 0.3s ease,color 0.5s ease';
      arqText.style.transform = 'scale(1)';
      arqText.style.color = '#0ff';
    }, 150);
  });

  arqBtn.addEventListener('mouseenter', playClickSound);

  // --- Player som ambiente Dopamina Sex ---
  const toggleSoundBtn = document.getElementById('toggleSound');
  let isPlaying = false;
  let gainNode = null;
  let oscillator = null;

  function startAmbientSound(){
    if(audioCtx.state === 'suspended') audioCtx.resume();
    oscillator = audioCtx.createOscillator();
    gainNode = audioCtx.createGain();
    oscillator.type = 'sine';
    oscillator.frequency.value = 220; // base da frequência ambiente
    gainNode.gain.value = 0.08; // volume inicial baixo
    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);
    oscillator.start();
  }
  function stopAmbientSound(){
    if(oscillator){
      oscillator.stop();
      oscillator.disconnect();
      gainNode.disconnect();
      oscillator = null;
      gainNode = null;
    }
  }

  toggleSoundBtn.addEventListener('click', () => {
    playClickSound();
    if(!isPlaying){
      startAmbientSound();
      toggleSoundBtn.textContent = 'Som: ON';
      toggleSoundBtn.setAttribute('aria-pressed', 'true');
    } else {
      stopAmbientSound();
      toggleSoundBtn.textContent = 'Som: OFF';
      toggleSoundBtn.setAttribute('aria-pressed', 'false');
    }
    isPlaying = !isPlaying;
  });

  toggleSoundBtn.addEventListener('mouseenter', playClickSound);

  // --- Infodose input placeholder - futura integração ---
  const infodoseInput = document.getElementById('infodoseInput');
  infodoseInput.addEventListener('input', () => {
    // Aqui pode-se processar e mesclar a base Infodose para customização futura
    // Por ora só loga para debug
    console.log('Base Infodose colada:', infodoseInput.value);
  });

})();
</script>

</body>
</html>